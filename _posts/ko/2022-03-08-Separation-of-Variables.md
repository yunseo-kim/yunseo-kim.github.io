---
title: 변수분리법(Separation of Variables)
description: 변수분리법에 대해 알아보고, 관련 예제 몇 가지를 소개한다.
categories: [Mathematics, Differential Equation]
tags: [ODE, First-Order ODEs]
math: true
image: /assets/img/math-and-physics-cropped.webp
---
## 변수분리법(Separation of Variables)
**분리 가능한 방정식(separable equation)**: 대수적 조작을 통해 $g(y)y'=f(x)$ 꼴로 나타낼 수 있는 방정식.

분리 가능한 방정식 $g(y)y'=f(x)$의 양변을 $x$에 관하여 적분하면 

$$ \int g(y)y'dx = \int f(x)dx + c $$ 

를 얻을 수 있고, $y'dx=dy$이므로 

$$ \int g(y)dy = \int f(x)dx + c $$

와 같이 변수 $x$에 관한 식과 $y$에 관한 식을 각각 우변과 좌변으로 분리할 수 있다. 만약 $f$와 $g$가 연속함수이면 위의 적분들을 계산하여 주어진 미분방정식의 일반해를 얻을 수 있다. 이와 같은 풀이 방법을 **변수분리법(separation of variables)** 이라 부른다. 

## 모델링 예제: 방사성 탄소 연대측정법 (Radiocarbon Dating)
외치(Oetzi)는 외츠탈(Oetztal) 알프스에서 [인류력](https://en.wikipedia.org/wiki/Holocene_calendar) 11991년에 발견된 신석기 시대 미라이다. 이 미라의 탄소-12에 대한 탄소-14의 비율이 살아 있는 유기체의 52.5%라면 Oetzi는 대략 언제쯤 살다가 죽었는가?
> 대기 중과 살아 있는 유기체에서는 탄소-12에 대한 방사성 탄소-14의 비율이 일정하다. 유기체가 죽으면 호흡과 식사에 의한 탄소-14의 흡수가 일어나지 않지만 탄소-14의 붕괴는 계속 일어나므로 방사성 탄소의 비율이 감소한다. 따라서 화석의 방사성 탄소 비율을 대기 중 방사성 탄소 비율과 비교하여 화석의 연대를 추정할 수 있다. 탄소-14의 반감기는 5715년이다.
{: .prompt-info }

### 풀이
상미분방정식 $y'=ky$를 변수분리하고 적분하면 

$$\frac {dy}{y}=k dt$$

$$ \log |y|=kt+c $$

$$ y=y_{0}e^{kt}\ (y_0=e^c) $$

가 된다. 상수 $k$를 결정하기 위해 반감기 $H=5715$를 사용한다.

$$ y_{0}e^{kH}=0.5y_0 $$

$$e^{kH}=0.5$$

$$ k=\frac {\log 0.5}{H}=-\frac {0.693}{5715}=-0.0001213. $$

마지막으로 외치(Oetzi)가 죽은 시간 $t$를 구하기 위해 비율 52.5%를 대입하면 

$$ e^{kt}=e^{-.0.0001213t}=0.525$$

$$ t=\frac {\log 0.525}{-0.0001213}=5312.$$

$$ \therefore \text{약 5310년 전, 인류력 6680년경 사망 추정}. $$

## 모델링 예제: 혼합 문제
초기에 탱크에 10kg의 소금이 용해된 1000L의 물이 들어 있다. 소금물이 분당 10L의 속도로 유입되는데 이 소금물에는 리터당 0.2kg의 소금이 용해되어 있다. 탱크 안의 혼합용액은 잘 휘저어져 균일하게 유지되며, 이 소금물이 분당 10L의 속도로 유출된다. 시간 $t$에서 탱크 안 소금의 양 $y(t)$를 구해라.

### 1. 모델 설정

$$ y'=\text{rate in} - \text{rate out}. $$

소금의 유입률은 분당 2kg이다. 소금물의 분당 유출량은 총 소금물 용량의 0.01이므로 소금의 분당 유출량은 $0.01 y(t)$이다. 따라서 모델은 상미분방정식 

$$y'=2-0.01y=-0.01(y-200) $$

이다.

### 2. 모델 풀이
앞서 세운 상미분방정식은 분리 가능하다. 변수분리하고 적분한 뒤 양변에 지수함수를 취하자.

$$ \frac {dy}{y-200}=-0.01 dt $$

$$ \log |y-200| = -0.01t+c^* $$

$$ y-200=ce^{-0.01t}. $$

초기에 탱크 안의 소금 양은 10kg이므로 초기조건은 $y(0)=10$이다. 위 식에 $y=10,\ t=0$을 대입하면 $10-200=ce^0=c$, 따라서 $c=-190$이다.

$$ \therefore y(t)=200-190e^{-0.01t} $$

즉, 주어진 상황에서 탱크 안 소금의 양은 200kg에 지수적으로 접근하여 수렴함을 알 수 있다.

## 모델링 예제: 뉴턴의 냉각 법칙(Newton's Law of Cooling)
겨울에 어느 사무실용 건물의 낮 시간대 온도가 20℃로 유지된다고 한다. 난방은 오후 10시에 꺼지고 오전 6시에 다시 켜진다. 어느 날 새벽 2시에 건물 내부 온도가 17.4℃였다. 외부 온도는 오후 10시에 10℃였고 오전 6시에는 4℃로 떨어졌다. 오전 6시에 난방기가 켜질 때 건물 내부 온도는 몇 도였을까?
> **뉴턴의 냉각 법칙(Newton's law of cooling)**  
> 어떤 물체의 온도 T의 시간에 대한 변화율은 물체와 그 주위의 온도차에 비례한다
{: .prompt-info }

### 1. 모델 설정
$T(t)$를 건물 내부의 온도라 하고 $T_A$를 외부의 온도라 하자. 그러면 뉴턴의 냉각 법칙에 의해 

$$ \frac {dT}{dt}=k(T-T_A) $$

가 된다.

### 2. 일반해
$T_A$가 10℃와 4℃ 사이에서 변화한다는 것만 알 뿐 정확히 어떤 값을 가지는지 알 수 없으므로 앞서 세운 식을 풀 수 없다. 이럴 때는 *보다 쉬운 문제로 상황을 단순화하여 풀이를 시도하면 도움이 될 수 있다*. 알고 있는 두 값의 평균은 7℃이므로, 미지의 함수 $T_A$를 상수함수 $T_A=7$로 가정하자. 정확하지 않더라도, 구하고자 하는 오전 6시의 건물 내부 온도 $T$의 근사적인 값을 얻을 것이라 기대할 수 있다.

상수 $T_A=7$에 대해 앞서 세운 상미분방정식은 분리 가능하다. 변수분리하고 적분하여 지수함수를 취하면 일반해를 얻을 수 있다.

$$ \frac {dT}{T-7}=k dt $$

$$ \log |T-7|=kt+c^* $$

$$ T(t)=7+ce^{kt} \quad(c=e^{c^*}).$$

### 3. 특수해
오후 10시를 $t=0$으로 선택하면 주어진 초기조건은 $T(0)=20$이 된다. 이때 얻는 특수해를 $T_p$라고 하자. 대입하면 

$$ T(0)=7+ce^0=20 $$

$$ c=20-7=13 $$

$$ T_p(t)=7+13e^{kt}. $$

### 4. $k$의 결정
오전 2시에 건물 내부 온도가 17.4℃였으므로 $T(4)=17.4$이다. 대수적으로 $k$의 값을 구하고 $T_p(t)$에 $k$를 넣으면 

$$ T_p(4)=7+13e^{4k}=17.4 $$

$$ e^{4k}=0.8 $$

$$ k=\frac {1}{4} \log 0.8=-0.056 $$

$$ T_p(t)=7+13e^{-0.056t}. $$

### 5. 답과 해석
오전 6시는 $t=8$이므로 

$$ T_p(8)=7+13e^{-0.056\cdot8}=15.3\text{[℃]}. $$

## 모델링 예제: 토리첼리의 정리(Torricelli's Theorem)
탱크의 직경이 2m이고 구멍의 지름이 1cm이며 구멍을 열 때 물의 초기 높이가 2.25m이다. 임의의 시간에 탱크의 물의 높이와, 탱크가 빌 때까지 걸리는 시간을 구하라.
> **토리첼리의 정리(Torricelli's theorem)**  
> 중력의 영향하에서 유출되는 물의 속력은
>
> $$ v(t)=0.600\sqrt{2gh(t)}. $$
>
> $h(t)$: 시간 $t$에서 구멍 위의 물의 높이
> $g=980\text{cm/s²}$: 지표면에서의 중력가속도
{: .prompt-info }

### 1. 모델 설정
짧은 시간 $\Delta t$ 동안의 유출량 $\Delta V$는

$$ \Delta V = Av\Delta t \qquad (A: \text{구멍의 면적})$$

이다. $\Delta V$는 탱크 안의 물의 부피의 변화 $\Delta V^*$와 같아야 한다. 또한

$$ \Delta V^* = -B\Delta h \qquad (B: \text{탱크의 단면적}) $$

인데, 여기서 $\Delta h(>0)$는 물의 높이 $h(t)$의 감소량이다. $\Delta V$와 $\Delta V^*$를 같다고 놓으면

$$ -B\Delta h = Av\Delta t $$

를 얻는다. 이제 토리첼리의 정리에 따라서 $v$를 나타내고, $\Delta t$를 한없이 0에 가까워지도록 하면 다음과 같이 1계 상미분방정식으로 표현되는 모델을 얻는다.

$$ \frac {\Delta h}{\Delta t} = -\frac {A}{B}v = -\frac{A}{B}0.600\sqrt{2gh(t)} $$

$$ \frac {dh}{dt} = \lim_{t\to0}\frac {\Delta h}{\Delta t} = -26.56\frac {A}{B}\sqrt{h}. $$

### 2. 일반해
이 상미분방정식은 분리 가능하다. 변수분리하고 적분하면

$$ \frac {dh}{\sqrt{h}} = -26.56\frac{A}{B}dt $$

$$ 2\sqrt{h} = c^* - 26.56\frac{A}{B}t $$

이다. 양변을 2로 나누고 제곱하면 $h=(c-13.28At/B)^2$을 얻는다. $13.28A/B=13.28 \cdot 0.5^2 \pi /100^2 \pi = 0.000332$를 대입하면 일반해

$$ h(t)=(c-0.000332t)^2 $$

를 얻는다.

### 3. 특수해
초기조건은 $h(0)=225\text{cm}$이다. $t=0$과 $h=225$를 대입하면 일반해로부터 $c^2=225, c=15.00$을 얻고, 따라서 특수해

$$ h_p(t)=(15.00-0.000332t)^2 $$

를 얻는다.

### 4. 탱크가 비기까지 걸리는 시간

$$ t = 15.00/0.000332 = 45181 \text{[s]} = 12.6 \text{[h]}. $$

## 분리 가능한 형태(separable form)로의 변환
분리 가능하지 않은 상미분방정식을 $y$에 대한 새로운 미지함수를 도입하는 변환을 통해 분리 가능하게 만들 수 있는 경우도 있다.

$$ y'=f\left(\frac {y}{x}\right). $$

이와 같은 상미분방정식을 풀 때는 $y/x=u$로 놓으면 

$$ y=ux,\quad y'=u'x+u $$

이므로, $y'=f(y/x)$에 대입하면 $u'x=f(u)-u$를 얻는다. 만약 $f(u)-u\neq0$이면 

$$ \frac {du}{f(u)-u}=\frac {dx}{x} $$

로 분리된다.
